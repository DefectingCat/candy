[[host]]
ip = "0.0.0.0"
port = 80
[[host.route]]
# route path: GET /
location = "/"
# static file path
root = "./html"

[[host]]
ip = "0.0.0.0"
port = 8080
[[host.route]]
location = "/"
proxy_pass = "https://www.google.com/"

[[host]]
ip = "0.0.0.0"
port = 8081
server_name = "proxy.example.com"
[[host.route]]
location = "/"
forward_proxy = true
proxy_timeout = 30
max_body_size = 10485760

[[host]]
ip = "0.0.0.0"
port = 8082
server_name = "loadbalance.example.com"
[[host.route]]
location = "/api"
upstream = "backend_servers"
proxy_timeout = 30
max_body_size = 1048576

[[host.route]]
location = "/data"
upstream = "api_servers"
proxy_timeout = 60

[[upstream]]
name = "backend_servers"
server = [
    { server = "192.168.1.100:8080", weight = 3 },
    { server = "192.168.1.101:8080", weight = 1 },
]

[[upstream]]
name = "api_servers"
server = [
    { server = "http://api1.example.com", weight = 2 },
    { server = "http://api2.example.com", weight = 3 },
    { server = "http://api3.example.com", weight = 1 },
]

# Example of iphash load balancing for session persistence
[[host]]
ip = "0.0.0.0"
port = 8083
server_name = "session.example.com"
[[host.route]]
location = "/app"
upstream = "session_servers"
proxy_timeout = 30

[[upstream]]
name = "session_servers"
method = "iphash"
server = [
    { server = "192.168.1.102:8080", weight = 1 },
    { server = "192.168.1.103:8080", weight = 1 },
    { server = "192.168.1.104:8080", weight = 1 },
]

# Example of active health check configuration
[[upstream]]
name = "health_check_servers"
method = "weighted_round_robin"
server = [
    { server = "192.168.1.105:8080", weight = 2 },
    { server = "192.168.1.106:8080", weight = 1 },
    { server = "192.168.1.107:8080", weight = 3 },
]
# Health check configuration
health_check = {
    interval = 3000,
    fall = 3,
    rise = 2,
    type = "http",
    check_http_send = "HEAD / HTTP/1.0\r\n\r\n",
    check_http_expect_alive = "200-399"
}
